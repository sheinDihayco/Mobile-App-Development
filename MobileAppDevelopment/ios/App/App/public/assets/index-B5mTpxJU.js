import{d as v,k as E,l as L,I as U,a as C,b as I,c as R,e as x,y as k,z as T,A,B as F,C as N,_ as O,g as S,w as p,r as d,o as B,h as m,i as q,j as g}from"./index-DaXFyowv.js";import{W as $,a as b,r as M}from"./index-Cwenx0lJ.js";var u;(function(s){s.Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS"})(u||(u={}));var f;(function(s){s.Rear="REAR",s.Front="FRONT"})(f||(f={}));var _;(function(s){s.Uri="uri",s.Base64="base64",s.DataUrl="dataUrl"})(_||(_={}));class w extends ${async getPhoto(t){return new Promise(async(n,a)=>{if(t.webUseInput||t.source===u.Photos)this.fileInputExperience(t,n,a);else if(t.source===u.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=t.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:t.promptLabelPhoto||"From Photos"},{title:t.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",async o=>{o.detail===0?this.fileInputExperience(t,n,a):this.cameraExperience(t,n,a)})}else this.cameraExperience(t,n,a)})}async pickImages(t){return new Promise(async(n,a)=>{this.multipleFileInputExperience(n,a)})}async cameraExperience(t,n,a){if(customElements.get("pwa-camera-modal")){const e=document.createElement("pwa-camera-modal");e.facingMode=t.direction===f.Front?"user":"environment",document.body.appendChild(e);try{await e.componentOnReady(),e.addEventListener("onPhoto",async o=>{const i=o.detail;i===null?a(new b("User cancelled photos app")):i instanceof Error?a(i):n(await this._getCameraPhoto(i,t)),e.dismiss(),document.body.removeChild(e)}),e.present()}catch(o){this.fileInputExperience(t,n,a)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(t,n,a)}fileInputExperience(t,n,a){let e=document.querySelector("#_capacitor-camera-input");const o=()=>{var i;(i=e.parentNode)===null||i===void 0||i.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",i=>{const r=e.files[0];let c="jpeg";if(r.type==="image/png"?c="png":r.type==="image/gif"&&(c="gif"),t.resultType==="dataUrl"||t.resultType==="base64"){const l=new FileReader;l.addEventListener("load",()=>{if(t.resultType==="dataUrl")n({dataUrl:l.result,format:c});else if(t.resultType==="base64"){const h=l.result.split(",")[1];n({base64String:h,format:c})}o()}),l.readAsDataURL(r)}else n({webPath:URL.createObjectURL(r),format:c}),o()}),e.addEventListener("cancel",i=>{a(new b("User cancelled photos app")),o()})),e.accept="image/*",e.capture=!0,t.source===u.Photos||t.source===u.Prompt?e.removeAttribute("capture"):t.direction===f.Front?e.capture="user":t.direction===f.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(t,n){let a=document.querySelector("#_capacitor-camera-input-multiple");const e=()=>{var o;(o=a.parentNode)===null||o===void 0||o.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input-multiple",a.type="file",a.hidden=!0,a.multiple=!0,document.body.appendChild(a),a.addEventListener("change",o=>{const i=[];for(let r=0;r<a.files.length;r++){const c=a.files[r];let l="jpeg";c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),i.push({webPath:URL.createObjectURL(c),format:l})}t({photos:i}),e()}),a.addEventListener("cancel",o=>{n(new b("User cancelled photos app")),e()})),a.accept="image/*",a.click()}_getCameraPhoto(t,n){return new Promise((a,e)=>{const o=new FileReader,i=t.type.split("/")[1];n.resultType==="uri"?a({webPath:URL.createObjectURL(t),format:i,saved:!1}):(o.readAsDataURL(t),o.onloadend=()=>{const r=o.result;n.resultType==="dataUrl"?a({dataUrl:r,format:i,saved:!1}):a({base64String:r.split(",")[1],format:i,saved:!1})},o.onerror=r=>{e(r)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(t){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new w;const W=M("Camera",{web:()=>new w}),D=v({name:"cameraScreen",components:{IonBackButton:E,IonButtons:L,IonToolbar:U,IonTitle:C,IonHeader:I,IonPage:R,IonContent:x,IonIcon:k,IonRouterOutlet:T},data(){return{}},methods:{async takePhoto(){(await W.getPhoto({quality:90,allowEditing:!0,resultType:_.Uri})).webPath}},setup(){return{menu:A,home:F,person:N}}}),H={class:"p-3"};function V(s,t,n,a,e,o){const i=d("ion-back-button"),r=d("ion-buttons"),c=d("ion-title"),l=d("ion-toolbar"),h=d("ion-header"),y=d("ion-content"),P=d("ion-page");return B(),S(P,null,{default:p(()=>[m(h,null,{default:p(()=>[m(l,null,{default:p(()=>[m(r,{slot:"start"},{default:p(()=>[m(i)]),_:1}),m(c,null,{default:p(()=>t[1]||(t[1]=[q(" Camera ")])),_:1})]),_:1})]),_:1}),m(y,null,{default:p(()=>[g("div",H,[g("button",{class:"btn btn-primary btn-lg w-100",onClick:t[0]||(t[0]=j=>s.takePhoto())}," Take a Photo ")])]),_:1})]),_:1})}const J=O(D,[["render",V]]);export{J as default};
